<!doctype html public "-//w3c//dtd html 4.0 transitional//en">

<html>
<meta http-equiv="Content-Type" content="text/html; charset=UFT-8">

<head>
<title>Radiation Damage</title>
<link rel="stylesheet" href="style_en.css">
</head>

<body>
<center><img src="logo_new.png" alt="logo" width="600"><br><br><h2>Radiation Damage</h2></center><br>

<h3>Overview of Radiation Damage MD</h3>


This lecture will be useful for those interested in the behavior of materials under irradiation, such as fusion, nuclear and accelerator materials.<br><br>
		
When high-energy particles such as protons or neutrons strike a solid material having a crystalline structure, the collided atoms are displaced from their positions within the crystal. If the displaced atom has high energy, it may displace another atom, and if this process repeats, the crystal structure becomes randomized.<br><br>

This disruption is called irradiation damage, and repeated exposure eventually degrades material strength. Therefore, ensuring the integrity of materials under radiation environments requires an accurate understanding of radiation damage. The fundamental basis for this understanding is the aforementioned atomic displacement phenomenon. Unlike the deformation processes studied previously, this phenomenon ends within an extremely short time, making it an ideal subject for applying molecular dynamics simulations.<br><br>

The interatomic potentials typically applied in metalic MDs are obtained by fitting appropriate function sets to calculations based on electronic states, namely first-principles calculation results. However, such interatomic potentials usually assume that "all atoms are placed at appropriate distances from their nearest neighbors." Nevertheless, when performing irradiation MD, atoms move at high speeds, so they are expected to come quite close to other atoms. Therefore, the interatomic potentials used thus far cannot provide accurate calculations.<br><br>

To be more specific about the problem, the repulsive term for short-range atomic interactions must be modeled. Here, we employ the Ziegler-Biersack-Littmark (ZBL) model as this short-range repulsive term. This short-range repulsive term must smoothly connect to the function describing the medium-to-long range. That is, we use a composite function that seamlessly changes the function used based on the interatomic distance. The interatomic potential used in this lecture incorporates the considerations outlined above. <br><br>

Actually, the description above may be somewhat challenging for MD beginners, many of them fail to recognize the issues with this interatomic potential. They often make mistakes by simply using the interatomic potential that came bundled with the LAMMPS code when they download it. <b>Potentials developed specifically for LAMMPS are not necessarily suitable for irradiation simulations</b>. Therefore, beginners performing simulations like those discussed here are advised to consult more experienced individuals regarding the appropriateness of the potential.
<br><br>

<h3>Execution of MD for Radiation Damage</h3>

How are irradiation effects introduced into materials modeled in MD? We do not model a high-energy particle like a neutron that collides with an atom on a material. Instead, the atom that first collides with and receives significant energy from the high-speed particle is modeled. This atom is called the Primary Knock-on Atom (PKA), and the MD is initiated by giving velocity to it.<br><br>

When a PKA is displaced with high energy, i.e., high velocity, it no longer remains at its initial lattice position. Instead, it collides with surrounding atoms, causing nearby atoms to be successively displaced from their lattice positions. At the same time, the temperature near the PKA rises sharply. However, over time, heat diffuses and the temperature near the PKA decreases, eventually reaching its equilibrium. At that point, the MD is terminated.<br><br>
		
The above heat diffusion is supposed to be appropriately modeled by the atomic interaction. However, if the box is small, heat becomes trapped within the box and fails to diffuse, ruin the heat diffusion phenomena. While enlarging the box resolves this issue, computational efficiency gets deteriorated in such a large box. Actually, there is a method to model thermal diffusion even with a small box. This involves treating the outer shell of the box as a thermal bath to dissipate heat generated by PKA. Details are described in the explanation of script below.
<br>
<br>

The script for radiation damage is <em>bccFe_cascade.lcm</em>. Its execution is performed as follows:
<pre>
$ lmp_serial -in script/bccFe_cascade.lcm
</pre>
If the execution completes successfully, a data file named <em>bccFe_cascade.out</em> will be created. Load this file into OVITO to check for the result using Common Neighbor Analysis (CNA) within OVITO's Modification feature.<br><br>

To perform this modification in OVITO, you must follow three modification steps in the pull-down menu labeled "Add modification": First, perform "Common Neighbor Analysis"; next, in "Expression selection," specify StructureType=="BCC"; finally, execute "Delete selected". After that, pressing the Play button at the bottom of the screen should display the video below.
<center>
<figure><video width="500" controls>
  <source src="bccFe_cascade.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video><br><figcaption>Video 1: Time development of radiation damage MD</figcaption><figure>
</center>
<br><br>

<h3>Step-by-Step Analysis of Input Script</h3>
<h4>Create the Target Crystal</h4>
Here is the first block of the script:
<pre>
variable   nsize equal 20 
variable   T equal 50.
</pre>
This block defines two important parameters for this MD as <em>variables</em>. The first line specifies the box size; as will become clear later, its unit is the lattice constant.<br><br>

Next is the material temperature, with the unit being K. Here, we set it to the cryogenic temperature of 50K. When analyzing only the displacement phenomenon, to minimize the influence of lattice vibrations, experiments are often conducted at cryogenic temperatures, not just in MD simulations.<br><br>

The next block is:
<pre>
units metal
boundary p p p
atom_style atomic
</pre>
We'll keep going as this block must be familiar to the audience.<br><br>

Here is the next block:
<pre>
lattice bcc 2.83
region box block 0 ${nsize} 0 ${nsize} 0 ${nsize}
create_box 1 box
create_atoms 1 box
mass 1 55.845
</pre>

In this block, the base crystal is created being also familier to the audience.
Here iron BCC crystal is created.<br><br>

The <code>mass</code> command at the bottom of the block defines the mass of the atomic species specified by the first argument. The <code>atom_style</code> command above defines attributes for each atom, which were sufficient in previous lectures. However, this time we need to add <em>mass</em> attribute.


<h4>Defining Atomic Interaction</h4>
The next block of script is as follows:
<pre>
pair_style eam/fs
pair_coeff * * ./potentials/Fe_Ackland04_ZBL.eam.fs Fe	
</pre>

As explained above, we will use an interatomic potential that seamlessly connects the ZBL model, which models short-range interactions, with a medium-to-long-range interaction model, rather than the previously used <em>Fe_mm.eam.fs</em>.
		
<pre>
neighbor 1.0 bin	
neigh_modify delay 5 check yes
</pre>

Next is the neighbor list configuration. Here, the skin is set to 1.0 Angstrom. For details on skin, please refer to the explanation of the <code>neigh_modify</code> command in the lecture <a href="shear_en.html">Shear Deformation</a>. Here, the skin is thinner than the default value of 2.0 Angstrom. Additionally, <code>neigh_modify</code> command define 5 as <em>delay</em> meaning that the neighbor list will not be updated for the next 5 calculation steps after the new update.

<h4>Defining Heat Bus and PKA</h4>
The next block is:
<pre>
variable nsize1 equal ${nsize}-2.
region   rallatoms block INF INF INF INF INF INF
region   rinterior block 2 ${nsize1} 2 ${nsize1} 2 ${nsize1}
region   rexterior block 2 ${nsize1} 2 ${nsize1} 2 ${nsize1} side out
group    interior region rinterior
group    exterior region rexterior
</pre>
This block defines the "outer shell region forming the thermal bath" described above. The shell thickness is set to twice the lattice constant. Practically, the atoms in the whole box is divided into an interior group and an exterior group outside it. Since you have already learned <code>variable</code>, <code>region</code>, and <code>group</code> command, you should be able to understand this script block based on that knowledge, except for a keyword <code>side out</code> of <code>region</code> command that gives a region outside of a specified <code>block</code>.<br><br>

This was the definition of the heat bath, and we'll move on to that of the PKA.
<pre>
variable nsize2 equal ${nsize}/2
region   rPKA sphere ${nsize2} ${nsize2} ${nsize2} 0.1
group    PKA region rPKA
</pre>

In this block, we define the PKA described above as a <em>group</em>. This is convenient because it allows us to assign velocity to the PKA. Here, we practically define a sphere with a radius of 0.1 Angstroms centered at the box's center, and atoms within this sphere should constitute "PKA" group. However, setting the radius to 0.1 Angstroms lets only the central atom belong to the group. This single-atom group will be treated as the PKA in subsequent scripts.

<h4>Thermodynamical Settings</h4>
<pre>
velocity all create ${T} 349876
fix          1 all nve
fix          2 exterior temp/rescale 1 ${T} ${T} 0.5 1.0 region rexterior
fix          3 interior temp/rescale 1 ${T} ${T} 0.5 1.0 region rinterior
</pre>

Next is <code>velocity...create</code> that sets the temperature. This was already explained in the lecture for <a href="anneal_en.html">Annealing</a>, where random velocities are assigned to atoms within the "all" group to set temperature to the system.
<br><br>

<code>fix ... nve</code> command specifies the use of an NVE ensemble during MD execution. As this command has already been introduced, no further explanation is provided here.<br><br>

We've already learnt <code>fix ... temp/rescale</code> command too. Here, the temperature is maintained at T in both the exterior and interior groups.

<h4>Preparing the Initial State</h4>

The next block is:
<pre>
timestep     0.001														      #-- timestep„ÅØ1 fs
thermo       100
thermo_style custom step temp pe etotal press
run          500
unfix        3
run          500
</pre>

<code>timestep</code> command defines the time width of one computational step in the simulation. Here, it is set to the default value of 1 fs.<br><br>

Since <code>thermo</code> and <code>thermo_style</code> have already appeared, they are not explained here. Audience who are unfamiliar with these should refer back to lectures such as <a href="shear_en.html">Shear Deformation</a>.<br><br>

The next <code>run</code> command is for annealing while adjusting the temperature of the entire box.<br><br>

Then, <code>unfix</code> command cancels the temperature adjustment inside the box. For the preparation of the subsequent radiation damage process, we now perform annealing without internal temperature adjustment. The second annealing is done by the <code>run</code> command at the bottom of the block.
<br><br>

<h4>Radiation Damage Simulation</h4>

The final block of script is:
<pre>
compute      eng all pe/atom
velocity     PKA set 12. 33. -200.
timestep     0.00001
dump         2 all custom 100 bccFe_cascade.out id type xs ys zs c_eng
reset_timestep	0
run          8000
</pre>
		
<code>compute</code> command defines thermodynamic variables to be calculated during the execution of <code>run</code> command. While <code>variable</code> command takes effect immediately, <code>compute</code> command merely declare a variable that will be calculated. In this case, the command declares the energy of each atom as a thermodynamic variable named <em>eng</em> whose value is referenced as <em>c_eng</em>.<br><br>

Now, the next <code>velocity</code> command assigns velocities to the PKA. Here, the velocities in the <em>x</em>, <em>y</em>, and <em>z</em> directions are given in Angstroms/ps. As you probably guess, the unit was defined by <code>units</code> command at the beginning of script.<br><br>

The next <code>timestep</code> command sets the time interval to <em>1/1000</em> of the usual value. This choice is made because atomic motion is extremely rapid immediately after the initial velocity is given to the PKA.<br><br>

Usage of <code>dump ... custom</code> command should be familier by now. Here, we are requesting to dump the attribute <em>c_eng</em> for each atom as well. This refers to the energy <em>eng</em> declared in the <code>compute</code> command above. Consequently, the energy of each atom will also be written to the dunmped file <em>bccFe_cascade.out</em>, in addition to atom's position. The command also specifies that the dumping occurs every 100 computational steps. Note that the <code>thermo</code> command above set the thermodynamical variables to be calculated every 100 time steps. Therefore, if any thermodynamical variables are referenced by <code>dump</code> command, the frequency of dumping must be 100 or a multiple thereof. Otherwise, LAMMPS will generate an run-time error. Unfortunately, the error message caused by this mistake doesn't clearly indicate what went wrong, making it a common pitfall for beginners.

<br><br>
In the last two lines, the time is initialized using the <code>reset_time</code> command, and the <code>run</code> command provides the velocity to the PKA, enabling subsequent time evolution.<br><br>

<h3>Further Discussion by <em>c_eng</em></h4>

Earlier in this lecture, we watched a video demonstrating the results of CNA analysis performed by loading the dumped file <em>bccFe_cascade.out</em> into OVITO. We can also visualize it using the thermodynamic variable <em>c_eng</em> calculated during the MD simulation. In the video below, atoms are colored according to their respective <em>c_eng</em> values and rendered in a cross-section passing through the center of the box. This demonstrates how defining new thermodynamic variables enables more diverse analyses.<br><br>

<center>
<figure>
<video width="500" controls>
  <source src="bccFe_cascade_c_eng.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video><br><br>
<figcaption>Video 2: The time development of radiation MD is visualized by potential energy values of atoms.</figcaption>
</figure>
</center>
<br><br>

Below is a video example demonstrating PKA with larger energy. Naturally, this requires a larger box. Running this size of MDs on a common PC might be a bit demanding.
<br><br>
<center>
<figure>
<video width="500" controls>
  <source src="Fe_cascade_large.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
<br><br>
<figcaption>Video 3: The time development of radiation MD initiated by a PKA with higher energy</figcaption>

<figure>
</center>
<br><br><br><br>

<center><a href="index.html">Contents</a>&nbsp&nbsp&nbspPrevious: <a href="tensile_en.html">Tensile Deformation</a>&nbsp&nbsp&nbspNect: <a href="read_data_en.html">Importing Initial States</a></center>
<br><br>
</body>
</html>
